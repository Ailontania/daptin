{
  "state_machine_descriptions": [
    {
      "name": "light_states",
      "label": "Light status",
      "initial_state": "green",
      "events": [
        {
          "name": "warn",
          "label": "warn",
          "src": [
            "green"
          ],
          "dst": "yellow"
        },
        {
          "name": "panic",
          "label": "panic",
          "src": [
            "yellow",
            "green"
          ],
          "dst": "red"
        },
        {
          "name": "calm",
          "label": "calm",
          "src": [
            "red"
          ],
          "dst": "yellow"
        },
        {
          "name": "calm",
          "label": "calm",
          "src": [
            "yellow"
          ],
          "dst": "green"
        }
      ]
    }
  ],
  "tables": [
    {
      "tableName": "style",
      "columns": [
        {
          "name": "name",
          "dataType": "varchar(500)",
          "columnType": "label"
        },
        {
          "name": "code",
          "dataType": "varchar(100)",
          "columnType": "label",
          "isUnique": true
        }
      ]
    },
    {
      "tableName": "orders",
      "columns": [
        {
          "name": "quantity",
          "dataType": "int(11)",
          "columnType": "measurement"
        }
      ]
    },
    {
      "tableName": "vendor",
      "columns": [
        {
          "name": "name",
          "columnType": "label",
          "dataType": "varchar(100)"
        }
      ]
    },
    {
      "tableName": "cost",
      "columns": [
        {
          "name": "pre_road_show_cost",
          "dataType": "int(11)",
          "columnType": "measurement"
        },
        {
          "name": "target_cost",
          "dataType": "int(11)",
          "columnType": "measurement"
        },
        {
          "name": "post_road_show_cost",
          "dataType": "int(11)",
          "columnType": "measurement"
        }
      ]
    },
    {
      "tableName": "style_file",
      "columns": [
        {
          "name": "color",
          "dataType": "varchar(100)",
          "columnType": "color"
        }
      ]
    }
  ],
  "relations": [
    {
      "subject": "cost",
      "relation": "belongs_to",
      "object": "style"
    },
    {
      "subject": "style",
      "relation": "has_one",
      "object": "style_file"
    },
    {
      "subject": "style",
      "relation": "has_many",
      "object": "orders"
    },
    {
      "subject": "orders",
      "relation": "has_one",
      "object": "vendor"
    }
  ],
  "actions": [
    {
      "name": "new_order",
      "label": "Create a new order for the style",
      "onType": "style",
      "fields": [
        {
          "columnName": "vendor",
          "name": "Vendor",
          "columnType": "vendor"
        },
        {
          "columnName": "quantity",
          "name": "quantity",
          "columnType": "measurement"
        }
      ],
      "outcomes": [
        {
          "type": "vendor",
          "method": "POST",
          "reference": "vendor1",
          "attributes": {
            "name": "vendor"
          }
        },
        {
          "type": "orders",
          "method": "POST",
          "reference": "order1",
          "attributes": {
            "vendor_id": "$vendor1.reference_id",
            "quantity": "quantity"
          }
        },
        {
          "type": "style_style_id_has_orders_orders_id",
          "method": "POST",
          "attributes": {
            "orders_id": "$order1.reference_id",
            "style_id": "$.reference_id"
          }
        }
      ]
    }
  ],
  "exchanges": [
    {
      "name": "Style to excel sync",
      "sourceAttributes": {
        "name": "style"
      },
      "sourceType": "self",
      "targetAttributes": {
        "sheetUrl": "https://content-sheets.googleapis.com/v4/spreadsheets/1Ru-bDk3AjQotQj72k8SyxoOs84eXA1Y6sSPumBb3WSA/values/A1:append"
      },
      "targetType": "gsheet-append",
      "attributes": [
        {
          "sourceColumn": "$style.title",
          "targetColumn": "Style title"
        }
      ],
      "options": {
        "hasHeader": true
      }
    },
    {
      "name": "Order to excel sync",
      "sourceAttributes": {
        "name": "orders"
      },
      "sourceType": "self",
      "targetAttributes": {
        "sheetUrl": "https://content-sheets.googleapis.com/v4/spreadsheets/1Ru-bDk3AjQotQj72k8SyxoOs84eXA1Y6sSPumBb3WSA/values/A1:append"
      },
      "targetType": "gsheet-append",
      "attributes": [],
      "options": {
        "hasHeader": true
      }
    },
    {
      "name": "Vendor to excel sync",
      "sourceAttributes": {
        "name": "vendor"
      },
      "sourceType": "self",
      "targetAttributes": {
        "sheetUrl": "https://content-sheets.googleapis.com/v4/spreadsheets/1Ru-bDk3AjQotQj72k8SyxoOs84eXA1Y6sSPumBb3WSA/values/A1:append"
      },
      "targetType": "gsheet-append",
      "attributes": [],
      "options": {
        "hasHeader": true
      }
    }
  ]
}
